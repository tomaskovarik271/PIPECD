# Manual Testing Scenarios: Custom Field Definition Management

**Feature:** Administration UI for Creating, Reading, Updating, and Deactivating/Reactivating Custom Field Definitions.

**UI Location:** `/admin/custom-fields`

## 1. Prerequisites

1.  User is logged in to the application.
2.  User has administrative privileges required to access and manage custom field definitions.
3.  Navigate to the "Custom Fields" administration page (typically found under an "Admin" section in the sidebar).

## 2. Test Environment

*   **Browser(s):** (Specify browser and version, e.g., Chrome 12X, Firefox 12X)
*   **Operating System:** (Specify OS, e.g., macOS Sonoma, Windows 11)
*   **Environment:** Development / Staging

## 3. Test Cases

For each test case, note the Steps, Expected Result, and provide space for Actual Result & Pass/Fail.

---

### 3.1. Create Custom Field Definition

| Test Case ID | Priority | Description                                                                 | Entity Type  | Field Type   | Other Details                                      | Steps                                                                                                                                                                                                                                                                                                                                                                                          | Expected Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Actual Result | Status (Pass/Fail) | Notes |
| :----------- | :------- | :-------------------------------------------------------------------------- | :----------- | :----------- | :------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------ | :----------------- | :---- |
| CFD-C-001    | High     | Create a basic 'TEXT' field for 'DEAL'                                      | DEAL         | TEXT         | Label: "Deal Notes", Name: "deal_notes", Required: No, Order: 1 | 1. Select "Deals" from entity type dropdown. <br> 2. Click "Add New Definition". <br> 3. Fill in Field Label: "Deal Notes". <br> 4. Fill in Field Name: "deal_notes". <br> 5. Select Field Type: "TEXT". <br> 6. Set Display Order: 1. <br> 7. Leave "Is Required?" unchecked. <br> 8. Click "Create Definition".                                                                                   | Modal closes. <br> Success toast: "Custom Field Definition Created...Deal Notes". <br> "Deal Notes" appears in the list for Deals with correct Label, Name, Type (TEXT), Status (Active), Order (1).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |               | Pass               |       |
| CFD-C-002    | High     | Create a 'NUMBER' field for 'PERSON', required                               | PERSON       | NUMBER       | Label: "Age", Name: "age", Required: Yes, Order: 0  | 1. Select "People" from entity type dropdown. <br> 2. Click "Add New Definition". <br> 3. Fill in Label: "Age", Name: "age". <br> 4. Select Type: "NUMBER". <br> 5. Check "Is Required?". <br> 6. Set Order: 0. <br> 7. Click "Create Definition".                                                                                                                                                | Modal closes. <br> Success toast. <br> "Age" field appears in the list for People with correct details, including being implicitly required (though the list doesn't show 'Required' status directly, the backend will store it).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |               | Pass               |       |
| CFD-C-003    | High     | Create a 'DATE' field for 'ORGANIZATION'                                    | ORGANIZATION | DATE         | Label: "Contract End", Name: "contract_end"        | 1. Select "Organizations". <br> 2. Click "Add New Definition". <br> 3. Fill in Label: "Contract End", Name: "contract_end". <br> 4. Select Type: "DATE". <br> 5. Click "Create Definition".                                                                                                                                                                                                     | Modal closes. <br> Success toast. <br> "Contract End" field appears in list for Organizations.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |               | Pass               |       |
| CFD-C-004    | High     | Create a 'BOOLEAN' field                                                    | DEAL         | BOOLEAN      | Label: "NDA Signed", Name: "nda_signed"            | 1. Select "Deals". <br> 2. Click "Add New Definition". <br> 3. Fill in Label: "NDA Signed", Name: "nda_signed". <br> 4. Select Type: "BOOLEAN". <br> 5. Click "Create Definition".                                                                                                                                                                                                           | Modal closes. <br> Success toast. <br> "NDA Signed" field appears in list for Deals.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |               | Pass               |       |
| CFD-C-005    | High     | Create a 'DROPDOWN' field with options                                      | PERSON       | DROPDOWN     | Label: "Lead Source", Name: "lead_source", Options: (val1,Label1), (val2,Label2) | 1. Select "People". <br> 2. Click "Add New Definition". <br> 3. Fill in Label: "Lead Source", Name: "lead_source". <br> 4. Select Type: "DROPDOWN". <br> 5. Click "Add Option". Enter Value: "website", Label: "Website". <br> 6. Click "Add Option". Enter Value: "referral", Label: "Referral". <br> 7. Click "Create Definition".                                                                  | Modal closes. <br> Success toast. <br> "Lead Source" field appears. <br> (Verify in DB or via edit that options are saved).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |               | Pass               |       |
| CFD-C-006    | High     | Create a 'MULTI_SELECT' field with options                                  | DEAL         | MULTI_SELECT | Label: "Competitors", Name: "competitors", Options: (compA,CompA), (compB,CompB) | 1. Select "Deals". <br> 2. Click "Add New Definition". <br> 3. Fill in Label: "Competitors", Name: "competitors". <br> 4. Select Type: "MULTI_SELECT". <br> 5. Add 2-3 options (e.g., Value: "comp_a", Label: "Competitor A"). <br> 6. Click "Create Definition".                                                                                                                                | Modal closes. <br> Success toast. <br> "Competitors" field appears. <br> (Verify options saved).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |               | Pass               |       |
| CFD-C-007    | Medium   | Create 'DROPDOWN' field, add then remove an option before saving           | PERSON       | DROPDOWN     | Label: "Temp Dropdown", Name: "temp_drop"        | 1. Select "People". <br> 2. Click "Add". <br> 3. Label: "Temp Dropdown", Name: "temp_drop", Type: DROPDOWN. <br> 4. Add option (val1, Lbl1). <br> 5. Add option (val2, Lbl2). <br> 6. Remove option (val1, Lbl1). <br> 7. Click "Create".                                                                                                                                                       | Modal closes. Success toast. Field created. When edited, only option (val2, Lbl2) should be present.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |               | Pass               |       |
| CFD-C-008    | Medium   | Create 'DROPDOWN' field with no options (should save as null options)       | DEAL         | DROPDOWN     | Label: "Empty Drop", Name: "empty_drop"            | 1. Select "Deals". <br> 2. Click "Add". <br> 3. Label: "Empty Drop", Name: "empty_drop", Type: DROPDOWN. <br> 4. Do NOT add any options. <br> 5. Click "Create".                                                                                                                                                                                                                                     | Modal closes. Success toast. Field created. `dropdownOptions` should be null or empty in the backend.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |               | Pass               |       |
| CFD-C-009    | High     | Validation: Missing Field Label                                             | DEAL         | TEXT         | Name: "test_name"                                  | 1. Select "Deals". <br> 2. Click "Add New Definition". <br> 3. Fill in Field Name: "test_name". <br> 4. Select Type: "TEXT". <br> 5. Click "Create Definition".                                                                                                                                                                                                                                      | Error message "Field Label is required" appears. Modal remains open. Form does not submit.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |               | Pass               |       |
| CFD-C-010    | High     | Validation: Missing Field Name                                              | DEAL         | TEXT         | Label: "Test Label"                                | 1. Select "Deals". <br> 2. Click "Add New Definition". <br> 3. Fill in Field Label: "Test Label". <br> 4. Select Type: "TEXT". <br> 5. Click "Create Definition".                                                                                                                                                                                                                                     | Error message "Field Name is required" appears. Modal remains open. Form does not submit.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |               | Pass               |       |
| CFD-C-011    | High     | Validation: Invalid Field Name (special characters)                         | DEAL         | TEXT         | Label: "Test", Name: "test name!"                  | 1. Select "Deals". <br> 2. Click "Add". <br> 3. Fill in Label: "Test", Name: "test name!". <br> 4. Select Type: "TEXT". <br> 5. Click "Create Definition".                                                                                                                                                                                                                                       | Error message "Field Name can only contain letters, numbers, and underscores." appears. Modal remains open.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |               | Pass               |       |
| CFD-C-012    | High     | Validation: Duplicate Field Name for same Entity Type                         | DEAL         | TEXT         | Label: "Deal Notes 2", Name: "deal_notes" (assuming CFD-C-001 exists) | 1. Ensure "deal_notes" exists for "DEAL". <br> 2. Select "Deals". <br> 3. Click "Add". <br> 4. Label: "Deal Notes 2", Name: "deal_notes". <br> 5. Type: "TEXT". <br> 6. Click "Create".                                                                                                                                                                                                      | Error toast from backend "Failed to create custom field definition." (or similar, indicating uniqueness constraint violation). Modal may close or remain. List should not show the duplicate.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |               | Pass               | UI Glitch: List of fields disappears from the page after successful backend update (duplicate name error correctly shown by backend, but frontend list refresh issue after modal closure/error handling). Requires manual page reload to see the list correctly again. |
| CFD-C-013    | Medium   | Validation: DROPDOWN options - missing value                                | PERSON       | DROPDOWN     | Label: "Opt Val", Name: "opt_val"                  | 1. Select "People". <br> 2. Click "Add". <br> 3. Label: "Opt Val", Name: "opt_val", Type: DROPDOWN. <br> 4. Add Option: Value: "", Label: "Test Label". <br> 5. Click "Create".                                                                                                                                                                                                                          | Error message "Value is required" for the option. Modal remains open.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |               | Pass               |       |
| CFD-C-014    | Medium   | Validation: DROPDOWN options - missing label                                | PERSON       | DROPDOWN     | Label: "Opt Label", Name: "opt_label"                | 1. Select "People". <br> 2. Click "Add". <br> 3. Label: "Opt Label", Name: "opt_label", Type: DROPDOWN. <br> 4. Add Option: Value: "test_val", Label: "". <br> 5. Click "Create".                                                                                                                                                                                                                        | Error message "Label is required" for the option. Modal remains open.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |               | Pass               |       |
| CFD-C-015    | Medium   | Cancel creation from modal                                                  | DEAL         | TEXT         | -                                                  | 1. Select "Deals". <br> 2. Click "Add New Definition". <br> 3. Fill some data. <br> 4. Click "X" (close button on modal) or press Esc.                                                                                                                                                                                                                                                                  | Modal closes. No new definition is created. List remains unchanged.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |               | Pass               |       |

---

### 3.2. Read / List Custom Field Definitions

| Test Case ID | Priority | Description                                                     | Steps                                                                                                                                           | Expected Result                                                                                                                                                                                                                                                        | Actual Result | Status (Pass/Fail) | Notes |
| :----------- | :------- | :-------------------------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------ | :----------------- | :---- |
| CFD-R-001    | High     | View list of definitions for 'DEAL'                             | 1. Create a few definitions for 'DEAL' (e.g., text, number). <br> 2. Select "Deals" from entity type dropdown.                                  | Table displays all active definitions for 'DEAL' with correct Label, Name, Type, Status ("Active"), and Order. Loading spinner shown initially if applicable.                                                                                                        |               |                    |       |
| CFD-R-002    | High     | Filter list by 'PERSON'                                         | 1. Create definitions for 'DEAL' and 'PERSON'. <br> 2. Select "People" from entity type dropdown.                                              | Table updates to show only definitions for 'PERSON'. Definitions for 'DEAL' are not visible.                                                                                                                                                                     |               |                    |       |
| CFD-R-003    | High     | Filter list by 'ORGANIZATION'                                   | 1. Create definitions for 'PERSON' and 'ORGANIZATION'. <br> 2. Select "Organizations" from entity type dropdown.                              | Table updates to show only definitions for 'ORGANIZATION'.                                                                                                                                                                                                           |               |                    |       |
| CFD-R-004    | Medium   | View empty list for an entity type with no definitions        | 1. Ensure "People" (or another type) has no definitions. <br> 2. Select "People" from entity type dropdown.                                   | Table displays a message like "No custom field definitions found for people."                                                                                                                                                                                    |               |                    |       |
| CFD-R-005    | Medium   | Status display (Active/Inactive)                                | 1. Create a definition. <br> 2. Deactivate it (see Deactivate tests). <br> 3. Reactivate it (see Reactivate tests).                            | Status column accurately reflects "Active" or "Inactive" state with appropriate tag styling (e.g., green for Active, red for Inactive). The `fetchCustomFieldDefinitions` call has `includeInactive = true` by default. |               |                    |       |
| CFD-R-006    | Low      | Display Order reflected in list (if not manually sortable)      | 1. Create two definitions for 'DEAL' with different Display Order values (e.g., 0 and 1).                                                       | Definitions are listed in an order consistent with their `displayOrder` values (store sorts by this).                                                                                                                                                              |               |                    |       |
| CFD-R-007    | High     | Loading state when fetching                                     | 1. Select an entity type from dropdown that has definitions. <br> 2. (If possible, simulate slow network or use browser dev tools).         | A loading spinner is displayed while definitions are being fetched. List is disabled or shows spinner overlay.                                                                                                                                               |               |                    |       |
| CFD-R-008    | High     | Error state when fetching fails                                 | 1. (Simulate API error for fetching definitions - e.g. network disconnect, backend error). <br> 2. Select an entity type.                   | An error message/alert is displayed (e.g., "Error loading definitions!"). List area shows the error instead of table/spinner.                                                                                                                                  |               |                    |       |

---

### 3.3. Update Custom Field Definition

| Test Case ID | Priority | Description                                                                | Steps                                                                                                                                                                                                                               | Expected Result                                                                                                                                                                                                                                                                                                                                                           | Actual Result | Status (Pass/Fail) | Notes |
| :----------- | :------- | :------------------------------------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :------------ | :----------------- | :---- |
| CFD-U-001    | High     | Edit Field Label                                                           | 1. Create a definition (e.g., for DEAL, Label: "Old Label", Name: "edit_label"). <br> 2. Click "Edit" icon for this definition. <br> 3. Change Field Label to "New Label". <br> 4. Click "Update Definition".                      | Modal title is "Edit Custom Field Definition". <br> Submit button text is "Update Definition". <br> Field Name and Field Type are disabled. <br> Modal closes. Success toast "Custom Field Definition Updated...New Label". <br> List updates to show "New Label". Other fields (Name, Type, etc.) remain unchanged.                                                              |               | Pass               |       |
| CFD-U-002    | High     | Edit Is Required (from false to true)                                      | 1. Create a TEXT field, "Is Required?" unchecked. <br> 2. Click "Edit". <br> 3. Check "Is Required?". <br> 4. Click "Update Definition".                                                                                           | Modal closes. Success toast. <br> (Verify in DB or by re-editing that `isRequired` is now true).                                                                                                                                                                                                                                                                         |               | Pass               |       |
| CFD-U-003    | High     | Edit Display Order                                                         | 1. Create a field with Display Order 5. <br> 2. Click "Edit". <br> 3. Change Display Order to 2. <br> 4. Click "Update Definition".                                                                                                     | Modal closes. Success toast. <br> List updates, potentially reordering if sort is dynamic (or verify value by re-editing/DB).                                                                                                                                                                                                                                          |               | Pass               |       |
| CFD-U-004    | High     | Edit Dropdown Options (add, remove, modify value/label)                    | 1. Create a DROPDOWN field with 2 options (optA, optB). <br> 2. Click "Edit". <br> 3. Add a new option (optC). <br> 4. Modify optA's label. <br> 5. Remove optB. <br> 6. Click "Update Definition".                                      | Modal closes. Success toast. <br> Re-edit the field. Verify optC is present, optA label is updated, optB is gone.                                                                                                                                                                                                                                                         |               | Pass               |       |
| CFD-U-005    | Medium   | Attempt to edit Field Name (should be disabled)                            | 1. Create a definition. <br> 2. Click "Edit". <br> 3. Observe Field Name input.                                                                                                                                                         | Field Name input is disabled and cannot be edited.                                                                                                                                                                                                                                                                                                                          |               | Pass               |       |
| CFD-U-006    | Medium   | Attempt to edit Field Type (should be disabled)                            | 1. Create a definition. <br> 2. Click "Edit". <br> 3. Observe Field Type select.                                                                                                                                                        | Field Type select dropdown is disabled and cannot be changed.                                                                                                                                                                                                                                                                                                             |               | Pass               |       |
| CFD-U-007    | High     | Validation: Edit Field Label to empty                                      | 1. Create a definition. <br> 2. Click "Edit". <br> 3. Clear Field Label. <br> 4. Click "Update Definition".                                                                                                                             | Error message "Field Label is required" appears. Modal remains open. Form does not submit.                                                                                                                                                                                                                                                                  |               | Pass               |       |
| CFD-U-008    | Medium   | Cancel edit from modal                                                     | 1. Create a definition. <br> 2. Click "Edit". <br> 3. Make some changes (e.g., to label). <br> 4. Click "X" (close button on modal) or press Esc.                                                                                     | Modal closes. No changes are saved to the definition. List remains unchanged from before edit attempt.                                                                                                                                                                                                                                                              |               | Pass               |       |
| CFD-U-009    | High     | Update submission fails (e.g. backend error)                               | 1. Create a definition. <br> 2. Click "Edit". <br> 3. Make a valid change. <br> 4. (Simulate backend error on update). <br> 5. Click "Update Definition".                                                                            | Error toast "Error Updating Definition..." appears. Modal may remain open or close. Definition in list is NOT updated.                                                                                                                                                                                                                                                 |               | Not Tested         |       |

---

### 3.4. Deactivate Custom Field Definition

| Test Case ID | Priority | Description                                                                | Steps                                                                                                                                                                                                    | Expected Result                                                                                                                                                                                                                                                                                                                                                                                            | Actual Result | Status (Pass/Fail) | Notes |
| :----------- | :------- | :------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------ | :----------------- | :---- |
| CFD-D-001    | High     | Deactivate an active definition                                            | 1. Create an active definition (Label: "To Deactivate"). <br> 2. In the list, click the "Deactivate" icon (NotAllowedIcon) for this definition.                                                              | Confirmation dialog "Deactivate Definition" appears: "Are you sure you want to deactivate the custom field definition 'To Deactivate'?" with "Cancel" and "Deactivate" buttons.                                                                                                                                                                                                                          |               | Pass               |       |
| CFD-D-002    | High     | Confirm deactivation                                                       | 1. Follow CFD-D-001. <br> 2. In the confirmation dialog, click "Deactivate".                                                                                                                                 | Dialog closes. <br> Success toast "Definition Deactivated...To Deactivate". <br> The definition's status in the list changes to "Inactive" (e.g., red tag). <br> The "Deactivate" icon changes to a "Reactivate" icon (CheckIcon). <br> Other action buttons (Edit) may still be available. `isSubmitting` state disables buttons during action. |               | Pass               |       |
| CFD-D-003    | High     | Cancel deactivation from confirmation dialog                               | 1. Follow CFD-D-001. <br> 2. In the confirmation dialog, click "Cancel".                                                                                                                                    | Dialog closes. <br> No toast. <br> The definition remains "Active" in the list. Its icon remains "Deactivate".                                                                                                                                                                                                                                                                                          |               | Pass               |       |
| CFD-D-004    | High     | Deactivation fails (e.g. backend error)                                    | 1. Follow CFD-D-001. <br> 2. (Simulate backend error on deactivate). <br> 3. Click "Deactivate" in dialog.                                                                                                     | Dialog closes. <br> Error toast "Error Deactivating Definition..." appears. <br> Definition remains "Active".                                                                                                                                                                                                                                                                                           |               | Not Tested         |       |
| CFD-D-005    | Medium   | Deactivate button `isDisabled` state during other submissions              | 1. Open the "Add New Definition" modal. <br> 2. Observe a "Deactivate" button on an existing definition in the background list. <br> 3. Or, while an activate/deactivate is in progress for another row. | The "Deactivate" button should be disabled (`isSubmitting` is true).                                                                                                                                                                                                                                                                                                                                        |               | Not Tested         |       |


---

### 3.5. Reactivate Custom Field Definition

| Test Case ID | Priority | Description                                                              | Steps                                                                                                                                                                                                      | Expected Result                                                                                                                                                                                                                                                                                                                                                                                             | Actual Result | Status (Pass/Fail) | Notes |
| :----------- | :------- | :----------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------ | :----------------- | :---- |
| CFD-RA-001   | High     | Reactivate an inactive definition                                        | 1. Deactivate a definition (Label: "To Reactivate", Status: Inactive). <br> 2. In the list, click the "Reactivate" icon (CheckIcon) for this definition.                                                       | Confirmation dialog "Reactivate Definition" appears: "Are you sure you want to reactivate the custom field definition 'To Reactivate'?" with "Cancel" and "Reactivate" buttons.                                                                                                                                                                                                                         |               | Pass               |       |
| CFD-RA-002   | High     | Confirm reactivation                                                     | 1. Follow CFD-RA-001. <br> 2. In the confirmation dialog, click "Reactivate".                                                                                                                                 | Dialog closes. <br> Success toast "Definition Reactivated...To Reactivate". <br> The definition's status in the list changes to "Active" (e.g., green tag). <br> The "Reactivate" icon changes to a "Deactivate" icon (NotAllowedIcon). `isSubmitting` state disables buttons during action.                                                                                                       |               | Pass               |       |
| CFD-RA-003   | High     | Cancel reactivation from confirmation dialog                             | 1. Follow CFD-RA-001. <br> 2. In the confirmation dialog, click "Cancel".                                                                                                                                     | Dialog closes. <br> No toast. <br> The definition remains "Inactive" in the list. Its icon remains "Reactivate".                                                                                                                                                                                                                                                                                           |               | Pass               |       |
| CFD-RA-004   | High     | Reactivation fails (e.g. backend error)                                  | 1. Follow CFD-RA-001. <br> 2. (Simulate backend error on reactivate). <br> 3. Click "Reactivate" in dialog.                                                                                                     | Dialog closes. <br> Error toast "Error Reactivating Definition..." appears. <br> Definition remains "Inactive".                                                                                                                                                                                                                                                                                            |               | Not Tested         |       |
| CFD-RA-005   | Medium   | Reactivate button `isDisabled` state during other submissions            | 1. Open the "Add New Definition" modal. <br> 2. Observe a "Reactivate" button on an existing inactive definition. <br> 3. Or, while an activate/deactivate is in progress for another row.               | The "Reactivate" button should be disabled (`isSubmitting` is true).                                                                                                                                                                                                                                                                                                                                         |               | Not Tested         |       |

---

### 3.6. General UI/UX

| Test Case ID | Priority | Description                                                     | Steps                                                                                                   | Expected Result                                                                                                                                                               | Actual Result | Status (Pass/Fail) | Notes |
| :----------- | :------- | :-------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------ | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------ | :----------------- | :---- |
| CFD-UX-001   | High     | Global Loading State (isSubmitting) for Form                    | 1. Click "Add New Definition". <br> 2. Fill valid data. <br> 3. Click "Create Definition".              | Submit button in modal shows loading spinner. <br> Modal close button, form inputs might be disabled. <br> Action buttons in the main list (Add, Edit, Deactivate) are disabled. |               | Not Tested         | App is too fast now :) |
| CFD-UX-002   | High     | Global Loading State (isSubmitting) for Activate/Deactivate     | 1. Click "Deactivate" on a definition. <br> 2. In confirmation dialog, click "Deactivate".               | Confirmation dialog buttons show loading state or main button is loading. <br> Action buttons in the main list (Add, Edit, Deactivate on other rows) are disabled.              |               | Not Tested         | App is too fast now :) |
| CFD-UX-003   | Medium   | Entity Type dropdown disabled during loading/submission         | 1. Trigger a form submission (create/update). <br> 2. Observe Entity Type select dropdown in the header. | The Entity Type select dropdown should be disabled.                                                                                                                             |               | Not Tested         | App is too fast now :) |
| CFD-UX-004   | Medium   | Toast notifications persistence and closeability                | 1. Perform an action that triggers a toast (e.g., create definition).                                   | Toast appears for specified duration (e.g., 5s success, 9s error). <br> Toast has a close button.                                                                          |               | Not Tested         | App is too fast now :) |
| CFD-UX-005   | Low      | Keyboard navigation for modals and forms (basic check)          | 1. Open "Add New Definition" modal. <br> 2. Try to Tab through fields. <br> 3. Press Esc to close.     | Tabbing navigates through form elements logically. <br> Esc key closes the modal.                                                                                              |               | Not Tested         | App is too fast now :) |

---

## 4. Using Custom Fields on Entities (Example: Deals)

### 4.1. Create Entity with Custom Fields (Deal)

**Assumptions:** Active Custom Field Definitions for 'DEAL' have been pre-configured via the Admin UI (Section 3.1), including at least one of each type (TEXT, NUMBER, DATE, BOOLEAN, DROPDOWN, MULTI_SELECT) and some marked as required.

| Test Case ID | Priority | Description                                                                 | Steps                                                                                                                                                                                                                                                          | Expected Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Actual Result | Status (Pass/Fail) | Notes |
| :----------- | :------- | :-------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :------------ | :----------------- | :---- |
| CFD-UC-001   | High     | Render custom fields in 'Create Deal' modal                                 | 1. Open the 'Create Deal' modal.                                                                                                                                                                                                                               | All active, DEAL-specific custom field definitions are rendered as form inputs after standard deal fields. <br> Labels, input types (text, number, date, switch, select, checkbox group) match definitions. <br> Dropdown/Multi-select options are populated. <br> Required fields are visually indicated (e.g., asterisk or message). <br> Boolean fields default to false. |               | Pass               |       |
| CFD-UC-002   | High     | Submit 'Create Deal' form with various custom field values (all filled)     | 1. Open 'Create Deal' modal. <br> 2. Fill all standard required fields. <br> 3. Fill in values for ALL displayed custom fields, including selecting options for dropdown/multi-select, toggling boolean, entering text, number, date. <br> 4. Click "Save Deal". | Modal closes. Success toast for deal creation. <br> **Console Log Check:** `dealInput.customFields` array is populated correctly with objects like `{definitionId: "def_id", stringValue: "text"}` or `{definitionId: "def_id", numberValue: 123}` or `{definitionId: "def_id", booleanValue: true}` or `{definitionId: "def_id", dateValue: "YYYY-MM-DD"}` or `{definitionId: "def_id", selectedOptionValues: ["opt1", "opt2"]}`. <br> **DB Check:** New deal row has `custom_field_values` JSONB column populated with a JSON object where keys are field names and values are the actual stored values (e.g., `{"text_field": "abc", "num_field": 123, "bool_field": true, "multi_field": ["a", "b"]}`). | DB confirmed values: `{"deal_notes": "", "nda_signed": true, "competitors": ["comp_a"]}` | Pass               | User confirmed data saved to DB. Log for `dealInput.customFields` was implicitly correct due to successful save with typed values.      |
| CFD-UC-003   | High     | Submit 'Create Deal' with only required custom fields filled              | 1. Ensure at least one DEAL custom field is marked 'Required'. <br> 2. Open 'Create Deal' modal. <br> 3. Fill standard fields. <br> 4. Fill ONLY the required custom fields. Leave optional custom fields blank. <br> 5. Click "Save Deal".         | Modal closes. Success toast. <br> **Console Log Check:** `dealInput.customFields` contains entries for required fields with the new typed value structure. Optional fields with no input are NOT present. <br> **DB Check:** `custom_field_values` reflects only the entered required CFs with their natural JSON values.                                                                                                                   |               | Not Tested         |       |
| CFD-UC-004   | Medium   | Submit 'Create Deal' - validation for required custom fields                | 1. Ensure at least one DEAL custom field is marked 'Required'. <br> 2. Open 'Create Deal' modal. <br> 3. Fill standard fields. <br> 4. Do NOT fill the required custom field. <br> 5. Click "Save Deal".                                             | Modal remains open. <br> Error message displayed for the required custom field (e.g., "This field is required."). <br> Deal is NOT created.                                                                                                                                                                                                                                        |               | Not Tested         |       |
| CFD-UC-005   | Medium   | Stringification of custom field values for submission (all types)         | 1. For each custom field type (TEXT, NUMBER, DATE, BOOLEAN, DROPDOWN, MULTI_SELECT): <br> &nbsp;&nbsp; a. Create a deal, providing a value for this field. <br> &nbsp;&nbsp; b. Inspect `dealInput.customFields` in console log.          | `CustomFieldValueInput` in `customFields` array is correctly structured: <br> - TEXT: `{stringValue: "input string"}` <br> - NUMBER: `{numberValue: 123.45}` <br> - DATE: `{dateValue: "YYYY-MM-DD"}` <br> - BOOLEAN: `{booleanValue: true}` or `{booleanValue: false}` <br> - DROPDOWN: `{stringValue: "selected_value"}` <br> - MULTI_SELECT: `{selectedOptionValues: ["opt1","opt2"]}` |               | Not Tested         | Implied pass for types tested in CFD-UC-002. Need to check all.      |

---

### 4.2. Update Entity with Custom Fields (Deal)

**Assumptions:**
*   An "Edit Deal" modal/form exists.
*   It fetches and pre-populates existing standard deal fields and custom field values.
*   Custom fields are rendered based on active DEAL-specific `CustomFieldDefinition`s.
*   The `updateDeal` mutation uses `CustomFieldValueInput` similar to `createDeal`.

| Test Case ID | Priority | Description                                                                 | Steps                                                                                                                                                                                                                                                                                                                                                                                       | Expected Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Actual Result | Status (Pass/Fail) | Notes |
| :----------- | :------- | :-------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :------------ | :----------------- | :---- |
| CFD-UU-001   | High     | Load 'Edit Deal' modal with existing custom fields                          | 1. Create a Deal with various custom fields populated (e.g., Text: "Initial Text", Number: 100, Date: "2024-01-01", Boolean: true, Dropdown: "opt1", MultiSelect: ["ms_a", "ms_b"]). <br> 2. Open the 'Edit Deal' modal for this deal.                                                                                                                                                               | All active, DEAL-specific custom fields are rendered. <br> Inputs for these custom fields are pre-populated with their currently saved values. <br> - Text field shows "Initial Text". <br> - Number field shows 100. <br> - Date field shows "2024-01-01". <br> - Boolean switch is 'on'. <br> - Dropdown has "opt1" selected. <br> - Multi-select has "ms_a" and "ms_b" checked. <br> Required fields are indicated. |               | Pass               |       |
| CFD-UU-002   | High     | Update an existing text custom field value                                  | 1. Follow CFD-UU-001. <br> 2. Change the Text custom field value from "Initial Text" to "Updated Text". <br> 3. Click "Save Changes".                                                                                                                                                                                                                                                           | Modal closes. Success toast for deal update. <br> **DB Check:** The `custom_field_values` JSONB for the deal reflects `{"text_field_name": "Updated Text", ...}`. Other CF values remain unchanged.                                                                                                                                                                                                                                                                                                                   |               | Pass               | Assume `text_field_name` is the fieldName for the text CF. |
| CFD-UU-003   | High     | Update an existing number custom field value                                | 1. Follow CFD-UU-001. <br> 2. Change the Number custom field from 100 to 250. <br> 3. Click "Save Changes".                                                                                                                                                                                                                                                                                       | Modal closes. Success toast. <br> **DB Check:** `custom_field_values` has `{"number_field_name": 250, ...}`.                                                                                                                                                                                                                                                                                                                                                                                                          |               | Pass               |       |
| CFD-UU-004   | High     | Update an existing date custom field value                                  | 1. Follow CFD-UU-001. <br> 2. Change Date custom field from "2024-01-01" to "2024-06-15". <br> 3. Click "Save Changes".                                                                                                                                                                                                                                                                            | Modal closes. Success toast. <br> **DB Check:** `custom_field_values` has `{"date_field_name": "2024-06-15TXX:XX:XX.XXX_Z_", ...}` (ISO string).                                                                                                                                                                                                                                                                                                                                                                                    |               | Pass               |       |
| CFD-UU-005   | High     | Update an existing boolean custom field value (true to false)               | 1. Follow CFD-UU-001 (Boolean CF is true). <br> 2. Toggle the Boolean custom field to false. <br> 3. Click "Save Changes".                                                                                                                                                                                                                                                                         | Modal closes. Success toast. <br> **DB Check:** `custom_field_values` has `{"boolean_field_name": false, ...}`.                                                                                                                                                                                                                                                                                                                                                                                                        |               | Pass               |       |
| CFD-UU-006   | High     | Update an existing dropdown custom field value                              | 1. Follow CFD-UU-001 (Dropdown is "opt1"). <br> 2. Change Dropdown selection to "opt2" (assuming "opt2" is another valid option). <br> 3. Click "Save Changes".                                                                                                                                                                                                                               | Modal closes. Success toast. <br> **DB Check:** `custom_field_values` has `{"dropdown_field_name": "opt2", ...}`.                                                                                                                                                                                                                                                                                                                                                                                                      |               | Pass               |       |
| CFD-UU-007   | High     | Update an existing multi-select custom field (add/remove options)           | 1. Follow CFD-UU-001 (MultiSelect is ["ms_a", "ms_b"]). <br> 2. Uncheck "ms_a", check "ms_c" (assuming "ms_c" is a valid option). <br> 3. Click "Save Changes".                                                                                                                                                                                                                                 | Modal closes. Success toast. <br> **DB Check:** `custom_field_values` has `{"multi_select_field_name": ["ms_b", "ms_c"], ...}`.                                                                                                                                                                                                                                                                                                                                                                                                |               | Pass               |       |
| CFD-UU-008   | High     | Clear an optional text custom field (set to null/empty)                   | 1. Create a Deal with an optional Text CF having value "Has Text". <br> 2. Open 'Edit Deal'. <br> 3. Clear the value from the Text CF. <br> 4. Click "Save Changes".                                                                                                                                                                                                                            | Modal closes. Success toast. <br> **DB Check:** `custom_field_values` has `{"text_field_name": null}` or the key `text_field_name` is removed (depending on save logic for empty optional fields, null is preferred).                                                                                                                                                                                                                                                                                                  |               |                    | Behavior for empty string vs. null should be consistent. |
| CFD-UU-009   | High     | Add a value to a previously unset optional custom field                     | 1. Create a Deal where an optional Text CF "New Text" was not set. <br> 2. Open 'Edit Deal'. The "New Text" field should be empty. <br> 3. Enter "Value Added" into "New Text". <br> 4. Click "Save Changes".                                                                                                                                                                                             | Modal closes. Success toast. <br> **DB Check:** `custom_field_values` now includes `{"new_text_field_name": "Value Added", ...}`.                                                                                                                                                                                                                                                                                                                                                                                      |               |                    |       |
| CFD-UU-010   | Medium   | Validation for required custom field if cleared during edit                 | 1. Create a Deal. Ensure a DEAL custom field "Required Edit Text" is marked 'Required' and has a value. <br> 2. Open 'Edit Deal'. <br> 3. Clear the value from "Required Edit Text". <br> 4. Click "Save Changes".                                                                                                                                                                                 | Modal remains open. <br> Error message displayed for "Required Edit Text" (e.g., "This field is required."). <br> Deal is NOT updated with the cleared value for this field.                                                                                                                                                                                                                                                                                                                                                   |               |                    |       |
| CFD-UU-011   | Medium   | No changes to custom fields when only standard fields are updated           | 1. Create a Deal with CFs set (e.g., Text: "CF Original"). <br> 2. Open 'Edit Deal'. <br> 3. Change only a standard field (e.g., Deal Name). Do not touch any custom fields. <br> 4. Click "Save Changes".                                                                                                                                                                                       | Modal closes. Success toast. <br> **DB Check:** Standard field (Deal Name) is updated. The `custom_field_values` JSONB remains unchanged (e.g. `{"text_field_name": "CF Original"}`). No CFs are accidentally cleared or modified.                                                                                                                                                                                                                                                                                       |               |                    |       |
| CFD-UU-012   | Low      | Custom field definition becomes inactive after deal creation/before edit  | 1. Create a DEAL Text CF (Label: "Legacy Info", Name: "legacy_info"). <br> 2. Create a Deal and provide value "Old Data" for "Legacy Info". <br> 3. Deactivate the "Legacy Info" CF definition. <br> 4. Open 'Edit Deal' for the deal created in step 2. | The "Legacy Info" custom field should NOT be displayed in the 'Edit Deal' form (as it's now inactive). <br> **DB Check (after save, if other changes are made):** The "legacy_info": "Old Data" should persist in the deal's `custom_field_values` in the DB, even if not editable in the UI. This confirms that deactivating a field doesn't wipe existing data. |               |                    | This tests resilience of stored data. |

---

### 4.3. Display Custom Fields on Entity (Deal)

**Assumptions:**
*   A "Deal Detail" page/view exists that displays deal information.
*   This view fetches deal data including resolved `customFieldValues` (using the `Deal.customFieldValues` resolver).
*   Only active custom fields with set values are typically displayed.

| Test Case ID | Priority | Description                                                                 | Steps                                                                                                                                                                                                                                                           | Expected Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Actual Result | Status (Pass/Fail) | Notes |
| :----------- | :------- | :-------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------ | :----------------- | :---- |
| CFD-UD-001   | High     | Display various populated custom fields on Deal Detail view                 | 1. Create a Deal with several active custom fields of different types populated (Text, Number, Date, Boolean, Dropdown, Multi-select). <br> 2. Navigate to the Detail View for this Deal.                                                                                 | A section for "Custom Fields" (or similar) is visible. <br> Each custom field with a value is displayed with its Field Label and formatted value: <br> - Text: "User Text" <br> - Number: 123.45 <br> - Date: Formatted date (e.g., "January 15, 2024") <br> - Boolean: "Yes"/"No" or "True"/"False" or icon. <br> - Dropdown: Label of the selected option (e.g., "Website Referral"). <br> - Multi-select: Comma-separated list of selected option labels (e.g., "Competitor A, Competitor B"). |               |                    |       |
| CFD-UD-002   | High     | Deal with no custom fields set                                              | 1. Create a Deal, but do not provide values for any custom fields (or all optional CFs are left blank). <br> 2. Navigate to the Detail View for this Deal.                                                                                                   | The "Custom Fields" section might be hidden, or show a message like "No custom information provided." <br> No custom field labels/values are displayed.                                                                                                                                                                                                                                                                                                                                                                                          |               |                    | This depends on the resolver returning empty array if no values are set. |
| CFD-UD-003   | Medium   | Display order of custom fields on Detail view                               | 1. Define multiple DEAL CFs with varying `displayOrder` values (e.g., LabelA Order 1, LabelB Order 0, LabelC Order 2). <br> 2. Create a Deal and provide values for all these CFs. <br> 3. Navigate to its Detail View.                                              | Custom fields are displayed in an order consistent with their `displayOrder` (LabelB, then LabelA, then LabelC).                                                                                                                                                                                                                                                                                                                                                                                                                                     |               |                    | Assumes resolver or frontend sorts by definition's displayOrder. |
| CFD-UD-004   | Medium   | Custom field definition becomes inactive after value was set                | 1. Define a DEAL Text CF (Label: "Sensitive Data", Name: "sensitive_data"). <br> 2. Create a Deal, value "Top Secret" for "Sensitive Data". <br> 3. Deactivate "Sensitive Data" CF definition. <br> 4. Navigate to the Detail View for the deal from step 2. | The "Sensitive Data" field and its value "Top Secret" should NOT be displayed (as the definition is inactive). <br> The `Deal.customFieldValues` resolver filters by active definitions.                                                                                                                                                                                                                                                                                                                              |               |                    | Confirms that UI respects active status for display. |
| CFD-UD-005   | Low      | Boolean field display (true/false variations)                             | 1. Create two Deals. <br> &nbsp;&nbsp; - Deal A: Boolean CF "Is VIP" set to true. <br> &nbsp;&nbsp; - Deal B: Boolean CF "Is VIP" set to false. <br> 2. View Detail for Deal A. <br> 3. View Detail for Deal B.                                                        | Deal A displays "Is VIP: Yes" (or equivalent). <br> Deal B displays "Is VIP: No" (or equivalent for false value).                                                                                                                                                                                                                                                                                                                                                                                                                   |               |                    |       |
| CFD-UD-006   | Low      | Date field formatting                                                       | 1. Create a Deal with a Date CF, value "2024-12-25T10:00:00.000Z". <br> 2. View Detail for this Deal.                                                                                                                                                           | Date is displayed in a user-friendly format (e.g., "December 25, 2024", not the raw ISO string).                                                                                                                                                                                                                                                                                                                                                                                                                                  |               |                    | Relies on frontend formatting. |

--- 